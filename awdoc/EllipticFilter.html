<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
    <script src="AndrewWIDE.js"></script>
	</head>
	<body>
		<textarea id="aw_json" class="awjson" hidden>

AW{"type":"javascript", "hidden":"true"}
let id = AndrewWIDE.suspend("Loading ellip.js");
require(['ellip'], function (e) {
  window.Ellip = e;
  AndrewWIDE.resume(id);
});

AW{"type":"mjmd"}

Elliptic Filter Design
======================

The design of [Elliptic filter](https://en.wikipedia.org/wiki/Elliptic_filter) requires the use the [elliptic rational function](EllipticRational.html) and [Jacobi elliptic functions](Jacobi.html).

The gain of the filter given angular frequency, $\omega$, is

$$ G_N(\omega) = \frac{1}{\sqrt{1+\epsilon^2 R_N^2(\xi,\omega/\omega_0)}} $$

Frequency response of fourth order, $N=4$, elliptic filter with ripple factor, $\epsilon = 0.5$ and selectivity factor, $\xi = 1.05$.

AW{"type":"javascript"}
let N = 4;
let eps = 0.5;
let xi = 1.05;

let x = [];
for (let n=0; n < 400; n++) {
  let x_val = 3 * n / 400;
  x.push(x_val);
}

let r = Ellip.R(N, xi, x);

let G = r.R.map((r_val) => 1 / Math.sqrt(1 + eps * eps * r_val * r_val));
plot(x,G);
xlabel("&omega;/&omega;<sub>0</sub>")
ylabel("G(&omega;)");

Gstop = 1/Math.sqrt(1 + eps * eps * r.L * r.L);
Gpass = 1/Math.sqrt(1 + eps * eps);
console.log(`Stop-band ripple = ${-20 * Math.log10(Gstop)}`);
console.log(`Pass-band ripple = ${-20 * Math.log10(Gpass)}`);

AW{"type":"javascript"}
let N = 5;
let eps = 0.5088;  // Manually adjusted to get 1dB of pass-band ripple.
let xi = 1.218699; // Manually adjusted for 40dB of stop-band ripple.

let x = [];
for (let n=0; n < 400; n++) {
  let x_val = 3 * n / 400;
  x.push(x_val);
}

let r = Ellip.R(N, xi, x);

let G = r.R.map((r_val) => 1 / Math.sqrt(1 + eps * eps * r_val * r_val));
plot(x,G);
xlabel("ω/ω<sub>0</sub>")
ylabel("G(ω)");

Gstop = 1/Math.sqrt(1 + eps * eps * r.L * r.L);
Gpass = 1/Math.sqrt(1 + eps * eps);
console.log(`Stop-band ripple = ${-20 * Math.log10(Gstop)}`);
console.log(`Pass-band ripple = ${-20 * Math.log10(Gpass)}`);
console.log(`Zeros are ${r.p}`);

AW{"type":"mjmd"}

The poles of the gain equation are the zeros of its denominator.

$$ 1+\epsilon^2 R_N^2(\xi,\omega/\omega_0) = 0 $$

It is usual practice to assume $ \omega_0 = 1 $ and to frequency scale the poles (and zeros) at a later stage. Prior to frequency scaling the filter is referred to as a prototype.

For complex frequency, $ s = j\omega + \sigma $, $\omega$ is substituted as $\omega = -js$. These values and the definition of the elliptic rational function is then substituted into the denominator equation to give

$$ 1+\epsilon^2 \mathrm{cd}^2 \left(N\frac{K\left(\frac{1}{L_N(\xi)}\right)}{K\left(\frac{1}{\xi}\right)}\mathrm{cd}^{-1}\left(-js,\frac{1}{\xi}\right), \frac{1}{L_N(\xi)}\right) = 0 $$

Let

$$ w = \mathrm{cd}^{-1}\left(-js,\frac{1}{\xi}\right) $$

The denominator equation is then rewritten as

$$ 1+\epsilon^2 \mathrm{cd}^2 \left(N\frac{K\left(\frac{1}{L_N(\xi)}\right)}{K\left(\frac{1}{\xi}\right)}w, \frac{1}{L_N(\xi)}\right) = 0 $$

This is then re-arranged to solve for $w$

$$ \mathrm{cd} \left(N\frac{K\left(\frac{1}{L_N(\xi)}\right)}{K\left(\frac{1}{\xi}\right)}w, \frac{1}{L_N(\xi)}\right) = \frac{\pm j}{\epsilon} $$

$$ w = \frac{K\left(\frac{1}{\xi}\right)}{NK\left(\frac{1}{L_N(\xi)}\right)} \mathrm{cd}^{-1}\left(\frac{\pm j}{\epsilon}, \frac{1}{L_N(\xi)}\right) + \frac{nK}{N} $$

The calculation of the poles requires the inverse cd function of a complex argument which will be addressed in the page on [Jacobi elliptic functions](Jacobi.html)
		</textarea>
		<script>
      new AwDocViewer( "serverless" );
		</script>
	</body>
</html>
